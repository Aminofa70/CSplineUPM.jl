@testset "clamped boundary condition" begin
    x = [0., 1., 2., 3., 4.]
    y = exp.(x)
    CC = CSpline_coefs(x, y, 1, 0., 0.)  
    expected_a = [1.0, 2.718281828459045, 7.38905609893065, 20.085536923187668]
    expected_b = [0.0, 3.941566877103152, 3.400900788379342, 34.556595253565355]
    expected_c = [1.213278608273984, 2.728288268829172, -3.2689543575529854, 34.424648822739]
    expected_d = [0.5050032201850616, -1.9990808754607179, 12.564534393430662, -34.46863096634778]
    
    @test CC.a ≈ expected_a atol=1e-10
    @test CC.b ≈ expected_b atol=1e-10
    @test CC.c ≈ expected_c atol=1e-10
    @test CC.d ≈ expected_d atol=1e-10
end

##################################################################
##################################################################

@testset "not-a-knot boundary condition" begin
    x = [0., 1., 2., 3., 4.]
    y = exp.(x)
    CC = CSpline_coefs(x, y)  
    expected_a = [1.0, 2.718281828459045, 7.38905609893065, 20.085536923187668]
    expected_b = [1.2066726763652742,2.7122095150090706,7.111657560390396,20.942925527615216]
    expected_c =[0.029290617637516725,1.4762462210062797,2.9232018243750453,10.908066142849776]
    expected_d = [0.4823185344562546,0.4823185344562555,2.661621439491576,2.66162143949158]
    
    @test CC.a ≈ expected_a atol=1e-10
    @test CC.b ≈ expected_b atol=1e-10
    @test CC.c ≈ expected_c atol=1e-10
    @test CC.d ≈ expected_d atol=1e-10
end

##################################################################
##################################################################
@testset "natural boundary condition" begin
    x = [0., 1., 2., 3., 4.]
    y = exp.(x)
    CC = CSpline_coefs(x, y,2,0.,0.)  
    expected_a = [1.0, 2.718281828459045, 7.38905609893065, 20.085536923187668]
    expected_b = [1.1111266016600043,2.932592282057127,6.325672566903439,23.866482734514992]
    expected_c = [0.0,1.8214656803971252,1.5716146044491843,15.969195563162366]
    expected_d =[0.607155226799041,-0.08328369198264518,4.799193652904396,-5.323065187720786]
    
    @test CC.a ≈ expected_a atol=1e-10
    @test CC.b ≈ expected_b atol=1e-10
    @test CC.c ≈ expected_c atol=1e-10
    @test CC.d ≈ expected_d atol=1e-10
end

##################################################################
##################################################################

@testset "linspace function" begin
    x = linspace(0.,10.,4)  
    expected_vector  = [0.0,3.333333333333333,6.666666666666666,10.0]
    @test x ≈ expected_vector atol=1e-10
    
end

##################################################################
##################################################################

@testset "spline  function not-a-knot" begin
    xdata = [0., 1., 2.5, 3.6, 5., 7., 8.1, 10.]
    ydata = sin.(xdata)
    f = CSplinef(xdata,ydata)
    sol = f(3.)
    @test sol ≈ 0.14653252176233017 atol=1e-10
    
end

##################################################################
##################################################################
@testset "spline  function clamped" begin
    xdata = [0., 1., 2.5, 3.6, 5., 7., 8.1, 10.]
    ydata = sin.(xdata)
    f = CSplinef(xdata,ydata,1,0.,0.)
    sol = f(3.)
    @test sol ≈ 0.1287259900493635 atol=1e-10
    
end
##################################################################
##################################################################
@testset "spline  function natural" begin
    xdata = [0., 1., 2.5, 3.6, 5., 7., 8.1, 10.]
    ydata = sin.(xdata)
    f = CSplinef(xdata,ydata,2,0.,0.)
    sol = f(3.)
    @test sol ≈ 0.14302859118434916 atol=1e-10
    
end

##################################################################
##################################################################
@testset "derivative of spline natural" begin
    xdata = [0., 1., 2.5, 3.6, 5., 7., 8.1, 10.]
    ydata = sin.(xdata)
    f = CSplinefDiff(xdata,ydata,2,0.,0.)
    sol = f(7.5)
    @test sol ≈ 0.3369639804838759 atol=1e-10
    
end
##################################################################
##################################################################